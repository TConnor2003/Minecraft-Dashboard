<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Minecraft Screenshots</title>
    <link rel="stylesheet" href="/gallery.css" />
    <link rel="icon" type="image/x-icon" href="/images/Favicon.png" />
  </head>
  <body>
    <div class="gallery">
      <script>
        const titles = {
          1:"Wide screenshot of my redstone testing world",
          3:"Collection of Beacons - just missing netherite",
          4:"Upsidown can doggo",
          5:"Auto Wither Killer",
          8:"The spoils of afking for a long time at a wither skeleton farm",
          9:"The creation of can doggo",
          10:"Command Block Fun",
          11:"Overkill? Whats That?",
          12:"Overkill but from a different angle",
          13:"A slight leak",
          14:"Full can doggo (unfortunately never finished in survival)",
          15:"Arial view of my base",
          16:"Almost Done",
          17:"Almost Done",
          18:"Almost Done",
          19:"Almost Done",
          20:"Almost Done",
          21:"Almost Done",
          22:"New mining Drill",
          23:"Mining away I don't know what to mine I'll mine this anyway",
          24:"Minecraft Cinematic Universe - MCU",
          25:"Ilmango Once said - I like to go caving. But i prefer to make my own cave",
          26:"Design by Borkon",
          27:"Wide area view of my base and the surrounding area",
          28:"Wide area view of my base and the surrounding area",
          29:"Wide area view of my base and the surrounding area",
          30:"Wide area view of my base and the surrounding area",
          31:"Wide area view of my base and the surrounding area",
          35:"Random blue base",
          36:"attempt 1",
          37:"Taste the rainbow",
          38:"Why did i think this was a good idea",
          39:"I like this one",
          40:"Finally a good one",
          44:"Map :)",
          48:"The first quarter drained",
          56:"Another Wide angle view of my base and the surrounding area",
          58:"Im on max render distance and i still cant see who tf asked",
          59:"Hey i can see my house from here",
          61:"Spawn coming along nicely",
          62:"Initial Spawn area - Inside a hollowed out mountain",
          63:"The docks before the ships were built",
          65:"Initial idea for spawn location",
          66:"VOID",
          67:"Hole made with SpookyClang go follow her on twitch at twitch.tv/spooky_clang",
          68:"Hole made with SpookyClang go follow her on twitch at twitch.tv/spooky_clang",
          69:"Nice",
          72:"Day 48567346 - All i see now is gold as far as the eye can see",
          73:"2K Piston Bolt",
          74:"Shop i built at spawn",
          75:"Shop i built at spawn",
          76:"Shop i built at spawn",
          77:"Shop i built at spawn",
          78:"Murder Time",
          79:"More Gold",
          84:"New Spawn Shop",
          88:"Dont ask",
          90:"Beefs unfinished castle #3487567346",
          94:"New Base with some friends",
          95:"Kaboom? Yes Rico Kaboom",
          96:"Kaboom but with shaders",
          105:"Storage With A Passion",
          106:"Start of a new Server",
          108:"Hermitcraft Joins the fun",
          109:"Base Made by Mop",
          110:"Base Made by Mop",
          111:"Sugar Cane Farm :)",
          112:"Starry Night Sky",
          113:"Another redstone world wide Shot"
        };

        let i = 1;
while (
  imageExists(`/images/Screenshots/compressed/Screenshot${i}.jpg`)
) {
  document.write(`
    <div class="gallery-item" onclick="showOverlay('${i}')">
      <img src="/images/Screenshots/compressed/Screenshot${i}.jpg" class="gallery-image" alt="Screenshot ${i}" id="${i}"/>
    </div>
  `);
  i++;
}

function imageExists(image_url) {
  var http = new XMLHttpRequest();
  http.open("HEAD", image_url, false);
  http.send();
  return http.status != 404;
}

function showOverlay(imageIndex) {
  const overlay = document.createElement("div");
  overlay.classList.add("overlay");
  overlay.addEventListener("click", hideOverlay);

  const image = document.createElement("img");
  image.src = `/images/Screenshots/compressed/Screenshot${imageIndex}.jpg`;

  const title = titles[imageIndex];

  const titleBox = document.createElement("div");
  titleBox.classList.add("title-box");
  titleBox.textContent = `Screenshot ${imageIndex}${title ? ": " + title : ""}`;
  overlay.appendChild(titleBox);

  overlay.appendChild(image);

  const downloadBox = document.createElement("div");
  downloadBox.classList.add("download-box");

  const copyUrlButton = document.createElement("button");
  copyUrlButton.classList.add("download-button");
  copyUrlButton.textContent = "Copy Download URL";
  copyUrlButton.addEventListener("click", () => {
    navigator.clipboard.writeText(image.src);
  });

  const copyCurrentUrlButton = document.createElement("button");
  copyCurrentUrlButton.classList.add("download-button");
  copyCurrentUrlButton.textContent = "Copy Current URL";
  copyCurrentUrlButton.addEventListener("click", () => {
    navigator.clipboard.writeText(window.location.href);
  });

  // Move the copy buttons to the download box
  downloadBox.appendChild(copyUrlButton);
  downloadBox.appendChild(copyCurrentUrlButton);

  // Create a download button
  const downloadButton = document.createElement("button");
  downloadButton.classList.add("download-button");
  downloadButton.innerHTML = '<i class="fa fa-download"></i> Download Raw Image';
  downloadButton.addEventListener("click", () => {
    // Download the image
    const xhr = new XMLHttpRequest();
    xhr.open("GET", `/images/Screenshots/raw/Screenshot${imageIndex}.png`);
    xhr.responseType = "blob";
    xhr.onload = () => {
      if (xhr.status === 200) {
        const blob = xhr.response;
        const link = document.createElement("a");
        link.href = window.URL.createObjectURL(blob);
        link.download = `Screenshot${imageIndex}.png`;
        link.click();
      } else {
        console.error("Error downloading image:", xhr.status);
      }
    };
    xhr.send();
  });

  downloadBox.appendChild(downloadButton);

  overlay.appendChild(downloadBox);

  document.body.appendChild(overlay);

  setTimeout(() => {
    overlay.classList.add("show");
  }, 10);

  // remove any existing hash from the URL bar
  if (window.location.hash) {
    window.history.pushState("", document.title, window.location.pathname);
  }

  // add the imageIndex to the URL bar as a hash
  window.history.pushState({}, '', `#${imageIndex}`);
}






function hideOverlay() {
  const overlay = document.querySelector(".overlay.show");
  overlay.classList.remove("show");

  setTimeout(() => {
    overlay.remove();
  }, 200);
  
  // remove the hash from the URL bar
  window.history.pushState("", document.title, window.location.pathname);
}

// scroll to the image specified in the URL hash when the page is loaded
window.addEventListener("load", () => {
  const hash = window.location.hash;
  if (hash) {
    const id = hash.slice(1);
    const element = document.getElementById(id);
    if (element) {
      element.scrollIntoView();
      showOverlay(id);
    }
  }
});
window.addEventListener("hashchange", () => {
  // Check the new hash
  const newHash = window.location.hash;

  // If the new hash is different from the old hash,
  // scroll to the image specified in the new hash
  if (newHash !== window.oldHash) {
    const id = newHash.slice(1);
    const element = document.getElementById(id);
    if (element) {
      element.scrollIntoView();
      showOverlay(id);
    }
  }

  // Save the new hash as the old hash
  window.oldHash = newHash;
});
      </script>
    </div>
  </body>
</html>
